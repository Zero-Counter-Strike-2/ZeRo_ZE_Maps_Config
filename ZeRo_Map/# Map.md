## 🤖 Assistant

# Map.json 使用指南

## 一、文件简介

`Map.json` 是 **ZeRo_MapRtv** 插件的核心地图数据库配置文件，用于定义服务器上可用的地图列表及其相关属性。通过此文件，您可以控制哪些地图可以被玩家提名、投票以及地图的冷却时间等机制。

## 二、文件位置

```
<服务器根目录>/configs/plugins/ZeRo_Map/Map.json
```

> **注意**：如果 `ZeRo_Map` 目录不存在，首次运行插件后会自动创建。您也可以手动创建此目录并放入 Map.json 文件。

## 三、文件结构详解

### 基本结构1

```json
{
  "地图文件名(不带后缀)": {
    "Id": "Steam工坊ID",
    "LangName": "地图中文名称",
    "JiFen": 积分要求,
    "Shuxing": "难度等级",
    "CD": 冷却时间(小时)
  }
}
```

### 字段说明

| 字段名称 | 类型 | 必填 | 说明 | 示例值 |
|---------|------|------|------|--------|
| **地图文件名** | 字符串 | ✅ | 服务器上地图文件名（不包含 `.bsp` 后缀），也是JSON对象的键名 | `"ze_aztecnoob_p"` |
| Id | 字符串 | ✅ | Steam工坊地图的ID（数字字符串） | `"3070231528"` |
| LangName | 字符串 | ✅ | 地图的中文显示名称（玩家可见） | `"阿兹特克遗迹"` |
| JiFen | 整数 | ✅ | 选择此地图所需的积分（可用于VIP系统限制） | `60` |
| Shuxing | 字符串 | ✅ | 地图难度等级标识 | `"简单"` |
| CD | 整数 | ✅ | 地图冷却时间（小时） | `12` |

## 四、关键概念解释

### 1. 地图文件名（JSON键名）

必须与服务器上实际地图文件名完全一致（不包含 `.bsp` 后缀）。例如：
- 如果服务器上有 `ze_aztecnoob_p.bsp` 文件，则键名应为 `ze_aztecnoob_p`
- 键名区分大小写，建议全部使用小写

### 2. 难度等级（Shuxing）

插件支持5个难度等级，用于排序和玩家筛选：
- `"简单"` - 适合新手，基础跳刀地图
- `"普通"` - 有一般挑战性的地图
- `"困难"` - 需要精准技巧的高级地图
- `"高难"` - 专业级挑战地图
- `"极难"` - 极限挑战地图

> **提示**：插件在显示地图列表时会按难度从低到高排序

### 3. 冷却时间（CD）

当一张地图被使用过之后，会进入冷却状态，冷却期间无法再次被选择。单位为**小时**。

例如：`"CD": 24` 表示该地图使用后需等待24小时才能再次被选择。

### 4. 积分要求（JiFen）

设置玩家选择此地图所需的最低积分。0表示无积分要求。

## 五、配置指南

### 1. 添加新地图

1. 确保地图文件已正确放入服务器 `csgo/maps/` 目录
2. 找到地图的Steam工坊ID（通常为纯数字）
3. 在 `Map.json` 文件中添加新的条目：

```json
"新地图文件名(不带后缀)": {
  "Id": "地图工坊ID",
  "LangName": "地图中文名称",
  "JiFen": 积分要求,
  "Shuxing": "难度等级",
  "CD": 冷却时间
}
```

**示例**：
```json
"ze_new_map_p": {
  "Id": "4000000000",
  "LangName": "全新测试地图",
  "JiFen": 75,
  "Shuxing": "普通",
  "CD": 18
}
```

### 2. 修改现有地图

直接编辑对应地图条目的值即可。例如修改"阿兹特克遗迹"的冷却时间为18小时：

```json
"ze_aztecnoob_p": {
  "Id": "3070231528",
  "LangName": "阿兹特克遗迹",
  "JiFen": 60,
  "Shuxing": "简单",
  "CD": 18 /* 修改此处 */
}
```

### 3. 删除地图

从JSON对象中移除对应的条目即可。插件会自动忽略不存在于Map.json中的地图。

## 六、维护建议

### 1. 难度与积分的平衡

| 难度级别 | 推荐积分范围 | 推荐冷却时间(小时) | 适用场景 |
|---------|-------------|-----------------|---------|
| 简单 | 30-60 | 8-12 | 新手地图，高频使用 |
| 普通 | 60-100 | 12-24 | 核心地图池 |
| 困难 | 100-200 | 24-48 | 高级挑战 |
| 高难 | 200-400 | 48-72 | 专业级地图 |
| 极难 | 400+ | 72+ | 顶级挑战 |

### 2. 冷却时间调整策略

- **玩家反馈地图太频繁**：增加CD值
- **某地图长期无人使用**：
  - 考虑降低JiFen要求
  - 或缩短CD时间（比如从24小时减到12小时）
- **最新热门地图**：适当缩短CD时间以提高曝光率

### 3. 常规维护

- **每月检查**：移除长期未更新或玩家反馈不佳的地图
- **添加新图**：当有新热门地图时及时添加
- **难度校准**：根据玩家反馈调整地图难度等级

## 七、常见问题

### 问题1：新增的地图在投票列表中看不到
**原因及解决方案**：
1. 检查文件路径是否正确：`/configs/plugins/ZeRo_Map/Map.json`
2. 确认JSON格式正确（建议使用JSON验证工具检查）
3. 确保地图文件名与Map.json中的键名完全一致
4. 重启插件或服务器使更改生效（部分插件支持热重载）

### 问题2：地图冷却时间不生效
**原因及解决方案**：
1. 确认CD值为正整数
2. 检查数据库连接是否正常（MapRtv插件需要MySQL数据库）
3. 确认插件版本是否支持CD功能

### 问题3：地图投票时显示英文名而非中文名
**原因及解决方案**：
1. 确认LangName字段已正确填写
2. 检查是否包含特殊字符或编码问题
3. 更新到最新版插件

## 八、高级配置示例

### 根据玩家水平调整配置

如果您想为不同水平的玩家提供不同的地图体验，可以这样配置：

```json
{
  "ze_aztecnoob_p": {
    "Id": "3070231528",
    "LangName": "阿兹特克遗迹",
    "JiFen": 0,
    "Shuxing": "简单",
    "CD": 8
  },
  "ze_eizures_b1_1": {
    "Id": "3102196028",
    "LangName": "核子工厂.起源",
    "JiFen": 300,
    "Shuxing": "高难",
    "CD": 48
  },
  "ze_ffvii_fako_reactor": {
    "Id": "3136003731",
    "LangName": "最终幻想fako",
    "JiFen": 999,
    "Shuxing": "高难",
    "CD": 1
  }
}
```

此配置：
- 简单地图无积分要求，冷却时间短
- 专业地图需要高积分
- 热门高难地图积分要求高但冷却时间短，增加曝光率

## 九、注意事项

1. **严格遵循JSON格式**：
   - 使用双引号 `"`
   - 不要添加注释（标准JSON不支持注释）
   - 确保没有多余的逗号

2. **大小写敏感**：
   - 地图文件名区分大小写
   - 建议全部使用小写

3. **特殊字符处理**：
   - 避免在LangName中使用特殊字符
   - 如必须使用，请确保编码为UTF-8

4. **备份习惯**：
   - 修改前备份原文件
   - 建议保留历史版本的Map.json

## 十、实用工具

1. **JSON验证工具**：
   - [JSONLint](https://jsonlint.com/)
   - [JSON Formatter](https://jsonformatter.org/)

2. **地图搜索命令**：
   - `!maplist` - 查看所有可用地图
   - `!nominate 搜索词` - 搜索并提名地图
   - `!mapinfo 地图名` - 查看地图详细信息

> **提示**：玩家可以使用中文或英文关键词搜索地图，例如 `!nominate 遗迹` 或 `!nominate aztec`

---

配置好Map.json后，您的服务器将拥有一个平衡、多样且符合玩家水平的地图轮换系统。定期更新此文件以反映玩家喜好和地图质量变化，将极大提升服务器的游戏体验。
